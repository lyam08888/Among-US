<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnostic Among Us</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a2e;
            color: white;
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
        .section {
            background: rgba(255, 255, 255, 0.1);
            margin: 20px 0;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        .success { border-left-color: #4CAF50; }
        .error { border-left-color: #f44336; }
        .warning { border-left-color: #ff9800; }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        
        .test-success {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
        }
        
        .test-error {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid #f44336;
        }
        
        pre {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>üîß Diagnostic Among Us V4</h1>
    
    <div class="section">
        <h2>Informations du navigateur</h2>
        <div id="browser-info"></div>
    </div>
    
    <div class="section">
        <h2>Test de chargement des fichiers</h2>
        <button onclick="testFiles()">Tester les fichiers</button>
        <div id="file-test-results"></div>
    </div>
    
    <div class="section">
        <h2>Test CSS</h2>
        <div style="width: 100px; height: 100px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 10px; margin: 10px 0;"></div>
        <p>Si vous voyez un carr√© bleu/violet ci-dessus, le CSS fonctionne.</p>
    </div>
    
    <div class="section">
        <h2>Test Canvas</h2>
        <canvas id="test-canvas" width="300" height="150" style="border: 1px solid white; background: #0a0a0f;"></canvas>
        <br>
        <button onclick="testCanvas()">Tester le Canvas</button>
    </div>
    
    <div class="section">
        <h2>Erreurs JavaScript</h2>
        <div id="js-errors"></div>
    </div>
    
    <div class="section">
        <h2>Actions</h2>
        <button onclick="location.href='test-basic.html'">Test Basique</button>
        <button onclick="location.href='index-simple.html'">Version Simplifi√©e</button>
        <button onclick="location.href='index.html'">Jeu Principal</button>
        <button onclick="location.reload()">Recharger</button>
    </div>

    <script>
        // Informations du navigateur
        function displayBrowserInfo() {
            const info = {
                'User Agent': navigator.userAgent,
                'Plateforme': navigator.platform,
                'Langue': navigator.language,
                'Cookies activ√©s': navigator.cookieEnabled,
                'Taille √©cran': `${screen.width}x${screen.height}`,
                'Taille fen√™tre': `${window.innerWidth}x${window.innerHeight}`,
                'URL': window.location.href,
                'Protocole': window.location.protocol,
                'Support Canvas': !!document.createElement('canvas').getContext,
                'Support WebGL': !!document.createElement('canvas').getContext('webgl'),
                'Support Audio': !!window.AudioContext || !!window.webkitAudioContext
            };
            
            let html = '';
            for (const [key, value] of Object.entries(info)) {
                html += `<p><strong>${key}:</strong> ${value}</p>`;
            }
            
            document.getElementById('browser-info').innerHTML = html;
        }
        
        // Test de chargement des fichiers
        async function testFiles() {
            const files = [
                'styles/v4-mobile-interface.css',
                'js/v4-app.js',
                'js/v3-engine.js',
                'assets/characters/crew-red-sheet.png',
                'debug-fix.js',
                'debug-styles.css'
            ];
            
            const results = document.getElementById('file-test-results');
            results.innerHTML = '<p>Test en cours...</p>';
            
            let html = '';
            
            for (const file of files) {
                try {
                    const response = await fetch(file, { method: 'HEAD' });
                    if (response.ok) {
                        html += `<div class="test-result test-success">‚úÖ ${file} - OK (${response.status})</div>`;
                    } else {
                        html += `<div class="test-result test-error">‚ùå ${file} - Erreur ${response.status}</div>`;
                    }
                } catch (error) {
                    html += `<div class="test-result test-error">‚ùå ${file} - ${error.message}</div>`;
                }
            }
            
            results.innerHTML = html;
        }
        
        // Test du canvas
        function testCanvas() {
            const canvas = document.getElementById('test-canvas');
            const ctx = canvas.getContext('2d');
            
            // Effacer le canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Dessiner un fond
            ctx.fillStyle = '#0a0a0f';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Dessiner un personnage simple
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.ellipse(150, 75, 30, 45, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Visi√®re
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.beginPath();
            ctx.ellipse(150, 60, 20, 15, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Texte
            ctx.fillStyle = 'white';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Test Canvas OK', 150, 130);
        }
        
        // Capturer les erreurs
        const errors = [];
        
        window.addEventListener('error', (e) => {
            errors.push({
                type: 'JavaScript Error',
                message: e.message,
                filename: e.filename,
                lineno: e.lineno,
                colno: e.colno,
                stack: e.error?.stack
            });
            updateErrorDisplay();
        });
        
        window.addEventListener('unhandledrejection', (e) => {
            errors.push({
                type: 'Promise Rejection',
                message: e.reason?.message || e.reason,
                stack: e.reason?.stack
            });
            updateErrorDisplay();
        });
        
        function updateErrorDisplay() {
            const errorDiv = document.getElementById('js-errors');
            if (errors.length === 0) {
                errorDiv.innerHTML = '<div class="test-success">Aucune erreur d√©tect√©e</div>';
            } else {
                let html = '';
                errors.forEach((error, index) => {
                    html += `<div class="test-error">
                        <strong>Erreur ${index + 1}: ${error.type}</strong><br>
                        Message: ${error.message}<br>
                        ${error.filename ? `Fichier: ${error.filename}:${error.lineno}:${error.colno}<br>` : ''}
                        ${error.stack ? `<pre>${error.stack}</pre>` : ''}
                    </div>`;
                });
                errorDiv.innerHTML = html;
            }
        }
        
        // Initialisation
        document.addEventListener('DOMContentLoaded', () => {
            displayBrowserInfo();
            updateErrorDisplay();
            console.log('üîß Diagnostic charg√©');
        });
    </script>
</body>
</html>